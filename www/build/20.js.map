{"version":3,"sources":["../../src/components/download-modal/download-modal.module.ts","../../src/components/download-modal/download-modal.ts"],"names":[],"mappings":"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","file":"20.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { DownloadModal } from './download-modal';\r\nimport { IonicModule, IonicPageModule } from 'ionic-angular';\r\n\r\n@NgModule({\r\n\tdeclarations: [DownloadModal],\r\n\timports: [\r\n\t\tIonicModule, \r\n\t\tIonicPageModule.forChild(DownloadModal)\r\n\t],\r\n\texports: [DownloadModal]\r\n})\r\nexport class DownloadModalModule {}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/download-modal/download-modal.module.ts","import { Platform, IonicPage, Toast, ActionSheet, ActionSheetButton, ActionSheetController, LoadingController, NavController, NavParams, ToastController, ViewController} from 'ionic-angular';\r\nimport { ApplicationRef, Component } from '@angular/core';\r\nimport { Attachment } from '../../models/attachment.model';\r\nimport { File } from '@ionic-native/file';\r\nimport { FileOpener } from '@ionic-native/file-opener';\r\nimport { Storage } from '@ionic/storage';\r\nimport { environment as ENV } from '../../environments/environment';\r\n\r\n@IonicPage({\r\n  name: 'download-modal'\r\n})\r\n@Component({\r\n  selector: 'page-download-modal',\r\n  templateUrl: 'download-modal.html',\r\n})\r\nexport class DownloadModal {\r\n  public ENV = ENV;\r\n  private _attachments: Attachment[] = [];\r\n  private readonly _ATTACHMENT_STORAGE_KEY: string = '__MOVERA_ATTACHMENT_STORAGE_KEY';\r\n\r\n  public videos: Array<any>;\r\n  public idiom: string = '';\r\n  public project: string;\r\n\r\n  constructor(\r\n    public navCtrl: NavController, \r\n    public navParams: NavParams,\r\n    public viewCtrl: ViewController,\r\n    public loadingCtrl: LoadingController,\r\n    private storage: Storage,\r\n    private toastCtrl: ToastController,\r\n    private actionSheetCtrl: ActionSheetController,\r\n    private file: File,\r\n    private appRef: ApplicationRef,\r\n    private fileOpener: FileOpener,\r\n    public _platform: Platform,\r\n\r\n  ) {}\r\n\r\n  ngOnInit(){\r\n    this.storage.get('Project').then((value)=>{\r\n      this.project = value;\r\n    });\r\n\r\n    this.storage.get('Idiom').then((value) => {\r\n      this.idiom = value;\r\n    })\r\n  }\r\n  close(){\r\n    this.viewCtrl.dismiss();\r\n  }\r\n\r\n  ionViewDidEnter() {\r\n    this.storage.get(this._ATTACHMENT_STORAGE_KEY).then((attachments) => {\r\n      if (attachments) {\r\n        this._attachments = attachments;\r\n      }\r\n    }).catch((_) => {\r\n      const toast: Toast = this.toastCtrl.create({\r\n        message: 'Houve um erro ao recuperar os itens baixados.',\r\n        duration: 6000,\r\n        position: 'top'\r\n      });\r\n      toast.present();\r\n    });\r\n  }\r\n\r\n  openContent($attachment: Attachment) {\r\n    let actions: ActionSheetButton[] = [];\r\n    if ($attachment.isVideo) {\r\n      actions.push({\r\n        icon: 'play',\r\n        text: 'Assistir',\r\n        handler: () => {\r\n          let documentDirectory = this._platform.is('android') ? this.file.dataDirectory : this.file.documentsDirectory;\r\n          this.fileOpener.open(`${documentDirectory}${$attachment.offlineFileName}`, $attachment.mimeType).then(() => {\r\n            // TODO\r\n          }).catch((err) => {\r\n            let toast = this.toastCtrl.create({\r\n              duration: 6000,\r\n              position: 'top',\r\n              message: this.idiom == '01' ? 'Não foi possível abrir o arquivo.' : this.idiom == '02' ? 'No es posible abrir el archivo.' : ''\r\n            });\r\n            toast.present();\r\n          });\r\n        }\r\n      });\r\n    } else {\r\n      actions.push({\r\n        icon: 'glasses',\r\n        text: 'Ver',\r\n        handler: () => {\r\n          let documentDirectory = this._platform.is('android') ? this.file.dataDirectory : this.file.documentsDirectory;\r\n          this.fileOpener.open(`${documentDirectory}${$attachment.offlineFileName}`, $attachment.mimeType).then(() => {\r\n            // TODO\r\n          }).catch((err) => {\r\n            let toast = this.toastCtrl.create({\r\n              duration: 6000,\r\n              position: 'top',\r\n              message: this.idiom == '01' ? 'Não foi possível abrir o arquivo.' : this.idiom == '02' ? 'No es posible abrir el archivo.' : ''\r\n            });\r\n            toast.present();\r\n          });\r\n        }\r\n      });\r\n    }\r\n    actions.push({\r\n      icon: 'trash',\r\n      text: 'Apagar',\r\n      handler: () => {\r\n        $attachment.isDownloading = true;\r\n        $attachment.downloadProgress = 0;\r\n        let documentDirectory = this._platform.is('android') ? this.file.dataDirectory : this.file.documentsDirectory;\r\n        this.file.removeFile(documentDirectory, $attachment.offlineFileName).then((removeResult) => {\r\n          if (removeResult.success) {\r\n            $attachment.isDownloading = false;\r\n            $attachment.downloadProgress = 0;\r\n            $attachment.isOffline = false;\r\n            $attachment.localUrl = '';\r\n            $attachment.mimeType = '';\r\n            $attachment.offlineFileName = '';\r\n            this.appRef.tick();\r\n            this._attachments = this._attachments.filter(f => f.id != $attachment.id);\r\n            this.storage.set(this._ATTACHMENT_STORAGE_KEY, this._attachments).then(() => {\r\n              let toast = this.toastCtrl.create({\r\n                duration: 6000,\r\n                position: 'top',\r\n                message: 'O arquivo foi removido.'\r\n              });\r\n              toast.present();\r\n            });\r\n          } else {\r\n            let toast = this.toastCtrl.create({\r\n              duration: 6000,\r\n              position: 'top',\r\n              message: this.idiom == '01' ? 'Não foi possível remover o arquivo.' : this.idiom == '02' ? 'No se pudo eliminar el archivo.' : ''\r\n            });\r\n            toast.present();\r\n          }\r\n        });\r\n      }\r\n    });\r\n    const actionSheet: ActionSheet = this.actionSheetCtrl.create({\r\n      title: 'O que deseja fazer?',\r\n      subTitle: `${$attachment.name}`,\r\n      buttons: actions\r\n    });\r\n    actionSheet.present();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/components/download-modal/download-modal.ts"],"sourceRoot":""}